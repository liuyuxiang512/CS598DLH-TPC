2022-04-26 19:20:39,075 - INFO - Config:
2022-04-26 19:20:39,076 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/MIMIC/LoS/LSTM",
    "batch_size": 512,
    "batch_size_test": 32,
    "batchnorm": "mybatchnorm",
    "bidirectional": false,
    "channelwise": false,
    "dataset": "MIMIC",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "LSTM",
    "hidden_size": 128,
    "intermediate_reporting": false,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00129,
    "loss": "msle",
    "lstm_dropout_rate": 0.2,
    "main_dropout_rate": 0.45,
    "mode": "train",
    "n_epochs": 8,
    "n_layers": 2,
    "name": "LSTM",
    "no_diag": true,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "percentage_data": 100.0,
    "save_results_csv": false,
    "seed": 911566561,
    "shuffle_train": false,
    "sum_losses": true,
    "task": "LoS"
}
2022-04-26 19:20:39,470 - INFO - Experiment set up.
2022-04-26 19:20:42,717 - INFO - BaseLSTM(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (lstm_dropout): Dropout(p=0.2, inplace=False)
  (main_dropout): Dropout(p=0.45, inplace=False)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (empty_module): EmptyModule()
  (lstm): LSTM(204, 128, num_layers=2, dropout=0.2)
  (diagnosis_encoder): Linear(in_features=1, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_los): Linear(in_features=161, out_features=17, bias=True)
  (point_mort): Linear(in_features=161, out_features=17, bias=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
)
2022-04-26 19:29:45,566 - INFO - Custom bins confusion matrix:
2022-04-26 19:29:45,567 - INFO - [[236479 526171 107381  41860  20664  11357   6947   4500   9522   3677]
 [ 91995 319074  99257  45807  25002  15169   9618   6397  14145   5119]
 [ 41017 187349  75135  38977  22787  14324   9498   6440  15126   5760]
 [ 21884 118644  56528  31887  19869  13012   8928   6273  14985   5773]
 [ 13488  81491  43914  26065  16764  11316   7988   5673  13952   5550]
 [  9013  58896  34633  21642  14310  10017   7110   5252  12744   5058]
 [  6480  44135  28462  18561  12451   8800   6331   4637  11750   4790]
 [  4712  34707  23590  15618  10802   7650   5534   4036  10683   4500]
 [ 13629 105231  80580  57555  41610  30523  22373  16897  44941  20316]
 [  7991  69998  67387  53292  40982  31375  23932  18413  52974  27313]]
2022-04-26 19:29:50,901 - INFO - Epoch: 0 | Train Loss: 133.7183
2022-04-26 19:31:42,278 - INFO - Custom bins confusion matrix:
2022-04-26 19:31:42,279 - INFO - [[70190 85336 30251 13449  5435  2571  1117   543   448     0]
 [24494 54371 27795 15414  7303  4371  1987  1071   828     6]
 [ 9874 30320 20457 13403  7786  4466  2728  1319   992     7]
 [ 4697 18290 14729 10763  7024  4400  2646  1428   991    19]
 [ 2545 11464 11002  8598  6029  4026  2432  1278   978     0]
 [ 1464  7431  7924  6911  5096  3787  2172  1175   827     2]
 [ 1127  5209  6122  5409  4070  3189  2077  1074   855     0]
 [  656  3954  4847  4735  3438  2829  1935   933   829     2]
 [ 1587 10766 15947 17035 14534 10954  7525  4248  4017    17]
 [ 1280  5081  9644 12765 12541 11620  8557  4696  5747   110]]
2022-04-26 19:31:43,747 - INFO - Epoch: 0 | Validation Loss: 110.3610
2022-04-26 19:40:53,963 - INFO - Custom bins confusion matrix:
2022-04-26 19:40:53,965 - INFO - [[346007 424016 107459  42962  20213  10445   5699   3673   6602   1482]
 [120449 268946 111892  53855  28578  16209   9866   6326  12613   2849]
 [ 49682 153244  85070  47368  27431  16554  10664   7188  15263   3949]
 [ 23635  94205  63927  38476  23940  15480  10282   7115  16067   4656]
 [ 13480  62534  48014  31354  20400  13810   9445   6704  15690   4770]
 [  8124  43657  37440  25674  17700  11971   8560   6124  14638   4787]
 [  5556  31825  30182  21711  14990  10602   7604   5691  13623   4613]
 [  3842  24647  24254  18162  13079   9241   6770   4918  12385   4534]
 [ 10363  70554  78935  64660  48632  36386  27605  20555  54626  21339]
 [  5622  42401  61352  55831  45750  36520  28346  22519  64188  31128]]
2022-04-26 19:40:59,034 - INFO - Epoch: 1 | Train Loss: 117.3829
2022-04-26 19:42:54,339 - INFO - Custom bins confusion matrix:
2022-04-26 19:42:54,340 - INFO - [[82844 75597 27219 12859  5537  2634  1382   623   645     0]
 [28485 49709 26610 14928  7844  4624  2746  1418  1269     7]
 [11270 27817 19103 12737  8193  5234  3404  1778  1795    21]
 [ 4988 17194 13631  9887  7029  4916  3389  1891  2015    47]
 [ 2692 10600  9730  7972  5811  4591  2969  1880  2099     8]
 [ 1539  6792  6828  6227  4907  4076  2907  1708  1787    18]
 [ 1027  4887  5200  5003  3813  3096  2577  1662  1862     5]
 [  768  3377  4376  4149  3232  2778  2244  1531  1685    18]
 [ 1723  9023 13866 14363 13256 11389  8847  5770  8295    98]
 [ 1397  4393  8284  9390 10368 10094  9280  6934 11706   195]]
2022-04-26 19:42:55,977 - INFO - Epoch: 1 | Validation Loss: 104.6053
2022-04-26 19:51:51,409 - INFO - Custom bins confusion matrix:
2022-04-26 19:51:51,410 - INFO - [[373719 404336 103685  40918  19067   9933   5730   3497   6318   1355]
 [127569 259926 112684  54833  28798  16641   9954   6372  12161   2645]
 [ 51560 146774  85730  48305  28535  17598  11305   7409  15592   3605]
 [ 23806  89348  64163  39946  24912  16093  10919   7528  16646   4422]
 [ 13349  58378  47636  32169  21602  14668   9975   7143  16458   4823]
 [  7767  40197  37422  26555  18151  12786   9190   6573  15306   4728]
 [  5307  29190  29403  22055  15764  11226   8086   5999  14729   4638]
 [  3721  22242  23704  18253  13506   9748   7125   5242  13603   4688]
 [  9963  62197  75878  64482  50312  38387  28902  21982  58885  22667]
 [  5312  35272  55486  54950  45729  38033  29854  23865  69976  35180]]
2022-04-26 19:51:56,656 - INFO - Epoch: 2 | Train Loss: 112.4474
2022-04-26 19:53:47,343 - INFO - Custom bins confusion matrix:
2022-04-26 19:53:47,344 - INFO - [[98731 66774 23297 10624  4674  2473  1232   669   863     3]
 [35621 47722 24523 12848  6977  4239  2666  1438  1580    26]
 [14486 27616 18175 11274  7578  4974  3308  1868  2039    34]
 [ 6744 17556 12886  8812  6588  4604  3287  1992  2454    64]
 [ 3621 11111  9288  7164  5494  4161  2994  1897  2583    39]
 [ 2031  7300  6474  5672  4624  3610  2885  1866  2258    69]
 [ 1334  5283  4901  4573  3523  2933  2463  1782  2308    32]
 [ 1017  3706  4158  3710  3035  2625  2227  1498  2109    73]
 [ 2443  9625 13259 13437 12546 10617  8645  5998  9751   309]
 [ 1677  4873  8404  8204  9492  9650  8049  7167 13811   714]]
2022-04-26 19:53:49,013 - INFO - Epoch: 2 | Validation Loss: 102.3907
2022-04-26 20:02:50,279 - INFO - Custom bins confusion matrix:
2022-04-26 20:02:50,281 - INFO - [[381220 403361 101353  39231  18111   9330   5331   3274   6026   1321]
 [129090 259607 113184  54347  28610  16196   9922   6242  11853   2532]
 [ 51060 146157  86118  48552  28721  17591  11500   7447  15592   3675]
 [ 23124  88258  64236  40081  25470  16701  11232   7536  16709   4436]
 [ 12657  57161  48086  32569  21970  14826  10297   7197  16686   4752]
 [  7379  38711  37275  26787  18515  13249   9419   6599  16044   4697]
 [  4913  27830  29062  22268  16084  11580   8587   6199  15170   4704]
 [  3424  20809  23598  18688  13704  10043   7499   5462  13899   4706]
 [  9284  58424  73462  64378  51313  39116  29743  23046  61245  23644]
 [  4921  31775  51692  53517  46333  37951  30691  24572  73874  38331]]
2022-04-26 20:02:55,275 - INFO - Epoch: 3 | Train Loss: 109.3236
2022-04-26 20:04:44,574 - INFO - Custom bins confusion matrix:
2022-04-26 20:04:44,575 - INFO - [[102661  65667  21535   9278   4584   2334   1342    776   1142     21]
 [ 37404  48413  22859  11918   6574   4098   2687   1662   1973     52]
 [ 15311  28152  17293  10586   7254   4931   3240   1982   2537     66]
 [  7184  18038  12178   8168   6407   4586   3191   2224   2924     87]
 [  3849  11435   8934   6578   5338   3975   3070   2031   3053     89]
 [  2111   7589   6142   5363   4471   3418   2811   2027   2759     98]
 [  1439   5473   4621   4262   3397   2851   2368   1882   2783     56]
 [  1082   3871   3971   3496   2821   2566   2119   1585   2535    112]
 [  2599  10040  12578  12516  11872  10145   8646   6157  11413    664]
 [  1780   5076   7992   7210   8786   9198   7853   6881  15755   1510]]
2022-04-26 20:04:46,181 - INFO - Epoch: 3 | Validation Loss: 101.3046
2022-04-26 20:13:44,231 - INFO - Custom bins confusion matrix:
2022-04-26 20:13:44,232 - INFO - [[384085 406449  98492  37594  17123   9141   5211   3188   6003   1272]
 [129027 262968 112674  53076  27883  16093   9712   6115  11575   2460]
 [ 50352 146752  86985  48526  28455  17489  11383   7496  15423   3552]
 [ 22549  88355  64034  39918  25661  16985  11323   7812  16671   4475]
 [ 12112  56601  47856  32612  22235  15072  10609   7573  16731   4800]
 [  7062  38083  36941  26612  18891  13304   9637   6924  16310   4911]
 [  4731  27250  28630  22177  16535  11911   8448   6202  15487   5026]
 [  3304  20104  23394  18381  13987  10352   7595   5678  14230   4807]
 [  8788  55668  71244  63609  51381  40090  31114  23760  63513  24488]
 [  4498  28910  48412  51347  46210  38538  31230  25479  77722  41311]]
2022-04-26 20:13:49,569 - INFO - Epoch: 4 | Train Loss: 106.7163
2022-04-26 20:15:39,396 - INFO - Custom bins confusion matrix:
2022-04-26 20:15:39,397 - INFO - [[103905  66409  20405   8494   4190   2395   1423    797   1271     51]
 [ 37694  49677  22136  11140   6432   3971   2727   1706   2075     82]
 [ 15419  29078  16656  10343   7081   4795   3219   2007   2677     77]
 [  7237  18525  11903   7854   6438   4388   3267   2265   3000    110]
 [  3858  11774   8685   6277   5412   3918   3106   2050   3164    108]
 [  2201   7774   6065   5170   4226   3595   2770   1982   2893    113]
 [  1464   5612   4643   4124   3251   2831   2408   1800   2926     73]
 [  1062   4069   3943   3377   2684   2593   2100   1618   2586    126]
 [  2668  10437  12455  11781  11637  10300   8510   6328  11634    880]
 [  1773   5252   7917   7011   8238   9094   7856   6864  16088   1948]]
2022-04-26 20:15:41,053 - INFO - Epoch: 4 | Validation Loss: 100.6365
2022-04-26 20:24:41,331 - INFO - Custom bins confusion matrix:
2022-04-26 20:24:41,332 - INFO - [[386107 410438  96417  35958  16205   8442   4898   3067   5738   1288]
 [128660 266884 111345  52209  27327  15862   9441   5956  11515   2384]
 [ 49825 148657  86363  48030  28463  17617  11242   7417  15221   3578]
 [ 21902  88756  64605  39832  25618  16888  11266   7728  16824   4364]
 [ 11810  56168  47986  32780  22164  15202  10606   7672  16974   4839]
 [  6981  37414  36657  26667  19112  13673   9682   6873  16682   4934]
 [  4606  26214  28328  22240  16593  12165   8906   6515  15776   5054]
 [  3094  19456  22990  18607  14066  10480   7714   5732  14702   4991]
 [  8376  52558  69031  62744  51752  40634  31673  24540  65952  26395]
 [  4279  26021  44732  48917  45167  38637  32199  26422  81381  45902]]
2022-04-26 20:24:46,352 - INFO - Epoch: 5 | Train Loss: 104.1258
2022-04-26 20:26:34,632 - INFO - Custom bins confusion matrix:
2022-04-26 20:26:34,633 - INFO - [[100344  69576  20115   8592   4162   2435   1519    969   1490    138]
 [ 35988  51075  21574  11446   6506   3975   2737   1829   2361    149]
 [ 14711  29469  16375  10422   7123   4816   3169   2145   2955    167]
 [  7006  18396  11761   7912   6295   4461   3379   2331   3251    195]
 [  3744  11553   8587   6427   5112   4050   3092   2217   3419    151]
 [  2138   7620   6066   5068   4242   3566   2726   2133   3093    137]
 [  1391   5465   4758   3998   3142   3023   2342   1765   3131    117]
 [   996   4080   3909   3299   2644   2597   2057   1557   2878    141]
 [  2595  10650  12240  11220  11269  10201   8396   6563  12414   1082]
 [  1737   5410   7751   6591   7998   8654   7902   7000  16729   2269]]
2022-04-26 20:26:36,169 - INFO - Epoch: 5 | Validation Loss: 100.6831
2022-04-26 20:35:30,593 - INFO - Custom bins confusion matrix:
2022-04-26 20:35:30,594 - INFO - [[388072 414856  93703  33819  15403   8151   4771   2924   5544   1315]
 [128561 269967 111510  50824  27016  15245   9304   5932  10890   2334]
 [ 49447 149933  86459  47753  28355  17495  11264   7368  14924   3415]
 [ 22028  88979  63883  40109  25703  17067  11147   7731  16700   4436]
 [ 11600  55838  48206  32696  22509  15287  10562   7449  17122   4932]
 [  6909  36678  36541  27159  19122  13692   9693   7029  16697   5155]
 [  4485  25657  28089  22238  16485  12302   9090   6584  16365   5102]
 [  3088  18767  22752  18549  14114  10587   7893   5941  14908   5233]
 [  7954  50280  66963  62297  51788  41407  31845  24889  68125  28107]
 [  4069  23400  41126  46506  44575  38835  32670  26983  85095  50398]]
2022-04-26 20:35:35,540 - INFO - Epoch: 6 | Train Loss: 101.8240
2022-04-26 20:37:25,885 - INFO - Custom bins confusion matrix:
2022-04-26 20:37:25,887 - INFO - [[101518  70221  19388   7949   3997   2296   1377    940   1528    126]
 [ 36691  51549  21358  10814   6516   3989   2626   1670   2304    123]
 [ 15326  29547  16293  10323   6762   4782   3260   1999   2912    148]
 [  7366  18702  11526   7736   6295   4391   3331   2224   3276    140]
 [  4055  11701   8589   6294   4935   4080   2975   2296   3270    157]
 [  2388   7749   6282   4806   4109   3475   2697   2080   3094    109]
 [  1520   5681   4775   3753   3330   2795   2324   1764   3078    112]
 [  1073   4252   3904   3052   2771   2527   2023   1589   2830    137]
 [  2860  11339  11982  10664  11472   9803   8079   6694  12747    990]
 [  1975   5813   7484   6376   8012   8454   7770   7116  17093   1948]]
2022-04-26 20:37:27,447 - INFO - Epoch: 6 | Validation Loss: 100.8148
2022-04-26 20:46:21,008 - INFO - Custom bins confusion matrix:
2022-04-26 20:46:21,010 - INFO - [[395032 413311  91463  32171  14680   7701   4592   2930   5390   1288]
 [130851 270924 109921  50506  26220  14819   9115   5839  11017   2371]
 [ 49741 151023  86284  47506  27663  17136  11052   7398  15136   3474]
 [ 22035  88473  64585  39747  25691  16871  11238   7771  17014   4358]
 [ 11683  55106  47687  33051  22409  15645  10982   7564  17229   4845]
 [  6883  36025  36051  26991  19531  14035   9849   7223  17135   4952]
 [  4405  25069  27761  22187  16801  12355   9233   6799  16561   5226]
 [  2960  18129  22569  18601  14045  10881   8071   5987  15359   5230]
 [  7620  47700  64873  61355  52496  42083  32694  25477  70458  28899]
 [  3834  21588  38131  45138  43831  39207  32992  27482  88031  53423]]
2022-04-26 20:46:26,272 - INFO - Epoch: 7 | Train Loss: 99.9086
2022-04-26 20:48:13,944 - INFO - Custom bins confusion matrix:
2022-04-26 20:48:13,945 - INFO - [[106119  65470  18731   8301   4047   2408   1495    900   1604    265]
 [ 39220  48432  21180  11140   6550   4266   2516   1655   2427    254]
 [ 16578  28029  16038  10302   6826   4892   3111   2152   3206    218]
 [  7990  17949  11257   7848   5926   4436   3403   2499   3485    194]
 [  4413  11133   8525   6303   4810   3983   2999   2275   3735    176]
 [  2600   7385   6274   4903   3916   3440   2549   2090   3477    155]
 [  1762   5440   4610   3710   3304   2773   2271   1748   3320    194]
 [  1191   4165   3784   3007   2715   2470   1979   1580   3075    192]
 [  3443  11090  11354  11009  10930   9487   7913   6718  13512   1174]
 [  2169   5534   7352   6262   7405   8173   7385   6809  18149   2803]]
2022-04-26 20:48:15,520 - INFO - Epoch: 7 | Validation Loss: 101.2548
2022-04-26 20:48:15,534 - INFO - Experiment ended. Checkpoints stored =)
