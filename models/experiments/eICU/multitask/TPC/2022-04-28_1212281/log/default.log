2022-04-28 12:12:28,102 - INFO - Config:
2022-04-28 12:12:28,103 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/eICU/multitask/TPC",
    "batch_size": 32,
    "batch_size_test": 32,
    "batchnorm": "mybatchnorm",
    "dataset": "eICU",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "TPC",
    "intermediate_reporting": false,
    "kernel_size": 4,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00226,
    "loss": "msle",
    "main_dropout_rate": 0.45,
    "mode": "train",
    "model_type": "tpc",
    "n_epochs": 15,
    "n_layers": 9,
    "name": "TPC",
    "no_diag": false,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "no_skip_connections": false,
    "no_temp_kernels": 12,
    "percentage_data": 100.0,
    "point_size": 13,
    "point_sizes": [
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13
    ],
    "save_results_csv": false,
    "seed": 2802454426,
    "share_weights": false,
    "shuffle_train": false,
    "sum_losses": true,
    "task": "multitask",
    "temp_dropout_rate": 0.05,
    "temp_kernels": [
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12
    ]
}
2022-04-28 12:12:33,687 - INFO - Experiment set up.
2022-04-28 12:12:36,567 - INFO - TempPointConv(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (main_dropout): Dropout(p=0.45, inplace=False)
  (temp_dropout): Dropout(p=0.05, inplace=False)
  (empty_module): EmptyModule()
  (diagnosis_encoder): Linear(in_features=293, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
  (layer_modules): ModuleDict(
    (0): ModuleDict(
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn_temp): MyBatchNorm1d(1044, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=241, out_features=13, bias=True)
      (temp): Conv1d(174, 1044, kernel_size=(4,), stride=(1,), groups=87)
    )
    (1): ModuleDict(
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn_temp): MyBatchNorm1d(1200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1298, out_features=13, bias=True)
      (temp): Conv1d(1300, 1200, kernel_size=(4,), stride=(1,), dilation=(3,), groups=100)
    )
    (2): ModuleDict(
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn_temp): MyBatchNorm1d(1356, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1454, out_features=13, bias=True)
      (temp): Conv1d(1469, 1356, kernel_size=(4,), stride=(1,), dilation=(6,), groups=113)
    )
    (3): ModuleDict(
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn_temp): MyBatchNorm1d(1512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1610, out_features=13, bias=True)
      (temp): Conv1d(1638, 1512, kernel_size=(4,), stride=(1,), dilation=(9,), groups=126)
    )
    (4): ModuleDict(
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn_temp): MyBatchNorm1d(1668, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1766, out_features=13, bias=True)
      (temp): Conv1d(1807, 1668, kernel_size=(4,), stride=(1,), dilation=(12,), groups=139)
    )
    (5): ModuleDict(
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn_temp): MyBatchNorm1d(1824, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1922, out_features=13, bias=True)
      (temp): Conv1d(1976, 1824, kernel_size=(4,), stride=(1,), dilation=(15,), groups=152)
    )
    (6): ModuleDict(
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn_temp): MyBatchNorm1d(1980, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2078, out_features=13, bias=True)
      (temp): Conv1d(2145, 1980, kernel_size=(4,), stride=(1,), dilation=(18,), groups=165)
    )
    (7): ModuleDict(
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn_temp): MyBatchNorm1d(2136, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2234, out_features=13, bias=True)
      (temp): Conv1d(2314, 2136, kernel_size=(4,), stride=(1,), dilation=(21,), groups=178)
    )
    (8): ModuleDict(
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn_temp): MyBatchNorm1d(2292, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2390, out_features=13, bias=True)
      (temp): Conv1d(2483, 2292, kernel_size=(4,), stride=(1,), dilation=(24,), groups=191)
    )
  )
  (point_last_los): Linear(in_features=2781, out_features=17, bias=True)
  (point_last_mort): Linear(in_features=2781, out_features=17, bias=True)
)
2022-04-28 12:37:18,777 - INFO - Custom bins confusion matrix:
2022-04-28 12:37:18,778 - INFO - [[1203600  678224  140322   44484   17221    7879    4123    2309    3945
      896]
 [ 407287  527084  176821   66148   28046   13667    7265    4088    6711
     1334]
 [ 132111  305646  166546   74992   35075   17882    9955    5811    9872
     2103]
 [  51115  163994  129226   71098   36845   19806   11485    7021   12544
     2896]
 [  24269   92406   92499   59069   33708   19778   11858    7415   14548
     3726]
 [  13588   57719   63951   46925   29131   18028   11394    7569   15415
     4335]
 [   7812   37372   47120   36496   24341   16119   10533    7172   15500
     4975]
 [   4745   25126   34699   29118   20385   13609    9443    6385   15038
     5193]
 [  10473   61283   95414   88825   67868   48586   35087   25256   62126
    26908]
 [   5193   31296   51553   52861   43269   33502   25073   18870   50052
    25159]]
2022-04-28 12:37:27,687 - INFO - Confusion matrix:
2022-04-28 12:37:27,688 - INFO - [[59565   656]
 [ 5925   769]]
2022-04-28 12:37:28,626 - INFO - Epoch: 0 | Train Loss: 102.1787
2022-04-28 12:41:09,182 - INFO - Custom bins confusion matrix:
2022-04-28 12:41:09,183 - INFO - [[299589 110422  25121   9104   3389   1309    516    249    240      3]
 [ 65710 122211  43658  18144   7344   3507   1451    558    630     29]
 [  9273  55443  45725  26094  12436   6441   3013   1464   1407     96]
 [  2568  18998  28293  23151  15053   8398   4588   2412   3087    239]
 [   873   7523  13968  16962  13671   9164   5349   2999   4643    390]
 [   618   3970   7959  10521  10222   8256   5803   3595   5478    726]
 [   408   2167   4200   6325   7143   6745   5365   3736   6612    759]
 [   280   1437   2764   3984   5083   5246   4392   3523   7097    819]
 [   653   3107   6191   9558  12041  13967  13400  12172  32268   7839]
 [   502   1535   2710   4305   6127   7758   7191   6895  25078   9587]]
2022-04-28 12:41:11,301 - INFO - Confusion matrix:
2022-04-28 12:41:11,301 - INFO - [[12919    45]
 [ 1229   118]]
2022-04-28 12:41:12,136 - INFO - Epoch: 0 | Validation Loss: 69.4267
2022-04-28 13:05:00,710 - INFO - Custom bins confusion matrix:
2022-04-28 13:05:00,712 - INFO - [[1480673  491870   86317   25726    9274    4139    2030    1112    1619
      243]
 [ 379071  581000  178522   56671   21522    9465    4746    2724    4054
      676]
 [  72556  291691  223477   91619   38195   18000    9449    5269    8320
     1417]
 [  20390  108356  164627   97855   49142   25738   14463    8512   14200
     2747]
 [   8815   44988   97268   79109   48169   28494   17168   10781   20105
     4379]
 [   4933   23429   56631   57073   40471   26512   17350   11526   23853
     6277]
 [   2931   13121   35208   40523   32256   22714   16043   11272   25429
     7943]
 [   1707    7753   22675   29379   24765   18839   13958   10114   25343
     9208]
 [   4523   17230   51361   73908   69861   58494   47182   36725  105483
    57059]
 [   2388    8740   24935   38114   39430   35045   30086   24638   79105
    54347]]
2022-04-28 13:05:11,023 - INFO - Confusion matrix:
2022-04-28 13:05:11,023 - INFO - [[59826   395]
 [ 5790   904]]
2022-04-28 13:05:12,084 - INFO - Epoch: 1 | Train Loss: 73.7221
2022-04-28 13:08:43,365 - INFO - Custom bins confusion matrix:
2022-04-28 13:08:43,366 - INFO - [[337336  87329  15465   5459   2175   1158    558    216    236     10]
 [ 55686 145306  39540  12298   4921   2605   1292    690    857     47]
 [  5418  56262  54009  23673  10134   5105   2918   1684   2117     72]
 [  1788  14474  30758  25171  14465   7839   4655   2855   4559    223]
 [   726   5327  13376  16085  13422   9350   5934   3849   6859    614]
 [   564   2823   6399   8946   9369   8382   6223   4454   8935   1053]
 [   284   1561   3130   4880   6150   6199   5191   4390  10195   1480]
 [   258    917   1935   2928   3740   4403   4099   3785  10615   1945]
 [   765   2031   3575   5704   8022   9324  10058  10265  44545  16907]
 [   478    916   1331   2327   3221   3900   4790   5689  28939  20097]]
2022-04-28 13:08:45,596 - INFO - Confusion matrix:
2022-04-28 13:08:45,596 - INFO - [[12920    44]
 [ 1186   161]]
2022-04-28 13:08:46,706 - INFO - Epoch: 1 | Validation Loss: 54.9482
2022-04-28 13:33:21,039 - INFO - Custom bins confusion matrix:
2022-04-28 13:33:21,040 - INFO - [[1552672  450547   66570   19361    7148    3014    1523     806    1192
      170]
 [ 336026  645993  172793   48434   17650    7798    3967    2136    3180
      474]
 [  50995  294186  250164   92271   35568   16075    8151    4407    7006
     1170]
 [  14225   92391  177819  107403   51421   25707   13993    7900   12928
     2243]
 [   6094   34481   96403   86275   52512   30574   17924   11082   19908
     4023]
 [   3704   17133   52459   59302   43489   29040   19028   12443   25294
     6163]
 [   2223    9495   30783   39769   33820   25194   17215   12325   28209
     8407]
 [   1361    5462   19192   27405   25082   20139   14963   11231   28628
    10278]
 [   3340   11789   40177   63893   65545   58142   48566   39297  120897
    70180]
 [   1635    5974   18715   30973   34433   32878   29557   25307   88003
    69353]]
2022-04-28 13:33:30,059 - INFO - Confusion matrix:
2022-04-28 13:33:30,060 - INFO - [[59825   396]
 [ 5645  1049]]
2022-04-28 13:33:31,330 - INFO - Epoch: 2 | Train Loss: 64.9154
2022-04-28 13:37:05,816 - INFO - Custom bins confusion matrix:
2022-04-28 13:37:05,817 - INFO - [[351688  79789  12426   3733   1340    520    225     96    124      1]
 [ 47172 160389  38889   9983   3668   1661    748    340    361     31]
 [  3982  57738  60679  22791   8466   3764   1934    954   1081      3]
 [  1416  14605  33933  26871  14452   7054   3803   2095   2444    114]
 [   666   5079  14248  17435  14256   9660   5390   3522   5079    207]
 [   373   2540   6658  10079  10064   8152   6423   4447   7954    458]
 [   273   1407   3227   5531   6224   5865   5499   4676   9911    847]
 [   256    823   1979   3231   3808   4091   4001   3989  10984   1463]
 [   548   1653   3541   5370   7443   8598  10129  10319  46261  17334]
 [   327    578   1148   2119   3050   3894   4532   5052  29201  21787]]
2022-04-28 13:37:08,167 - INFO - Confusion matrix:
2022-04-28 13:37:08,167 - INFO - [[12879    85]
 [ 1131   216]]
2022-04-28 13:37:09,455 - INFO - Epoch: 2 | Validation Loss: 48.3026
2022-04-28 14:01:21,047 - INFO - Custom bins confusion matrix:
2022-04-28 14:01:21,048 - INFO - [[1592159  427825   55524   15945    5778    2568    1269     698    1044
      193]
 [ 307572  690273  166383   43775   15631    6686    3269    1803    2655
      404]
 [  40105  296237  264926   91159   34135   14911    7402    3998    6128
      992]
 [  10893   82914  185566  113213   52514   25718   13407    7676   12037
     2092]
 [   4911   29030   94879   89730   55477   32087   18567   11203   19651
     3741]
 [   2835   13776   48824   60288   45786   30449   20244   13302   26417
     6134]
 [   1631    7562   27624   39645   34379   26065   18729   13323   29875
     8607]
 [   1062    4390   16710   26674   25149   20809   15752   11871   30414
    10910]
 [   2507    9580   34037   58852   62517   58002   49384   40857  129270
    76820]
 [   1281    4450   14973   26398   31910   31461   29296   25222   92877
    78960]]
2022-04-28 14:01:29,882 - INFO - Confusion matrix:
2022-04-28 14:01:29,883 - INFO - [[59745   476]
 [ 5508  1186]]
2022-04-28 14:01:30,941 - INFO - Epoch: 3 | Train Loss: 59.6096
2022-04-28 14:05:04,086 - INFO - Custom bins confusion matrix:
2022-04-28 14:05:04,089 - INFO - [[344689  88044  12632   2804   1048    333    144     82    160      6]
 [ 34590 171123  44290   8196   2873   1129    416    244    374      7]
 [  2717  51665  71984  22388   6886   2916   1284    670    844     38]
 [   983  11061  39418  29232  13589   6061   2967   1548   1834     94]
 [   536   3825  16075  19698  14894   8896   4743   2698   3972    205]
 [   368   1928   7581  11247  10819   8462   6108   3920   6303    412]
 [   237   1178   3737   5950   7088   6216   5324   4571   8247    912]
 [   221    679   2179   3857   4146   4268   4058   4033   9921   1263]
 [   381   1392   3736   6610   7910   9027   9576  10467  46806  15291]
 [   221    626   1156   2400   2992   3878   4573   5373  30326  20143]]
2022-04-28 14:05:06,607 - INFO - Confusion matrix:
2022-04-28 14:05:06,607 - INFO - [[12903    61]
 [ 1138   209]]
2022-04-28 14:05:07,971 - INFO - Epoch: 3 | Validation Loss: 45.6278
2022-04-28 14:29:27,820 - INFO - Custom bins confusion matrix:
2022-04-28 14:29:27,821 - INFO - [[1617794  412747   48529   14005    5075    2192    1095     591     857
      118]
 [ 287745  721689  161759   40286   13805    6031    2844    1609    2314
      369]
 [  33230  294564  276964   91636   32934   13749    6876    3583    5544
      913]
 [   8673   76006  190488  116792   54342   25693   13277    7302   11635
     1822]
 [   3967   25511   93805   92895   57236   32941   18898   11401   19136
     3486]
 [   2217   11935   47303   61153   47376   31347   20582   13741   26509
     5892]
 [   1336    6514   25748   39603   35056   26676   19230   13707   30984
     8586]
 [    784    3654   15299   25890   25375   21139   16213   12570   31627
    11190]
 [   1992    7923   30428   55659   60890   57542   49442   41787  134286
    81877]
 [    956    3615   13223   23601   29652   29880   28332   25601   95260
    86708]]
2022-04-28 14:29:38,308 - INFO - Confusion matrix:
2022-04-28 14:29:38,308 - INFO - [[59783   438]
 [ 5463  1231]]
2022-04-28 14:29:39,946 - INFO - Epoch: 4 | Train Loss: 56.1029
2022-04-28 14:33:49,681 - INFO - Custom bins confusion matrix:
2022-04-28 14:33:49,683 - INFO - [[364528  72221   8814   2494   1023    390    196     91    185      0]
 [ 37411 178508  34697   7279   2751   1243    636    292    397     28]
 [  2648  60478  65876  19320   6807   2971   1423    830   1004     35]
 [   994  12874  39818  26786  12925   6241   2992   1756   2342     59]
 [   539   4044  16096  18896  14177   8833   4996   3109   4718    134]
 [   284   1930   7422  10548  10665   8519   6029   3760   7574    417]
 [   200    973   3395   5958   6256   6594   5655   4260   9298    871]
 [   180    547   1861   3492   3902   4310   4118   4001  10783   1431]
 [   306   1050   2823   5641   6897   8056   9160  10317  49413  17533]
 [   215    399    960   1571   2379   3086   4086   5199  32460  21333]]
2022-04-28 14:33:52,632 - INFO - Confusion matrix:
2022-04-28 14:33:52,632 - INFO - [[12923    41]
 [ 1174   173]]
2022-04-28 14:33:54,184 - INFO - Epoch: 4 | Validation Loss: 41.8890
2022-04-28 14:59:49,502 - INFO - Custom bins confusion matrix:
2022-04-28 14:59:49,504 - INFO - [[1641314  398071   42856   12119    4468    1952     942     491     665
      125]
 [ 273464  746589  157064   37175   12635    5242    2605    1324    2049
      304]
 [  27579  291332  289400   90686   31885   13242    6490    3435    5177
      767]
 [   7213   67748  196572  120702   54792   25728   13281    7323   10925
     1746]
 [   3226   21322   92199   95906   59554   33733   19179   11557   19225
     3375]
 [   1852    9881   44644   61573   48727   33005   21612   13854   27051
     5856]
 [   1111    5395   24050   39058   35779   27355   19935   14062   32042
     8653]
 [    648    3080   13911   25393   25265   21668   16917   12839   32726
    11294]
 [   1548    6447   27505   52635   60230   57046   50316   42458  138500
    85141]
 [    732    2963   11523   21281   28374   28772   28006   25085   97687
    92405]]
2022-04-28 14:59:59,968 - INFO - Confusion matrix:
2022-04-28 14:59:59,969 - INFO - [[59757   464]
 [ 5420  1274]]
2022-04-28 15:00:01,128 - INFO - Epoch: 5 | Train Loss: 53.1295
2022-04-28 15:04:09,726 - INFO - Custom bins confusion matrix:
2022-04-28 15:04:09,730 - INFO - [[368657  69375   7810   2284    925    415    208    153    115      0]
 [ 37173 180435  33213   6993   2675   1306    657    383    392     15]
 [  2606  59502  67874  18517   6156   3013   1570    930   1221      3]
 [   957  11548  42023  27356  11824   5344   3170   1863   2622     80]
 [   449   3683  15708  20538  14544   7973   4525   3082   4812    228]
 [   252   1782   6782  11209  11081   8896   5778   3829   7048    491]
 [   189    942   3218   5579   6595   6861   5934   4404   8889    849]
 [   139    605   1747   3175   3887   4116   4710   4367  10793   1086]
 [   312   1181   2860   5022   6505   7831   9733  10690  51735  15327]
 [   183    401    989   1522   2088   3012   3983   4988  32994  21528]]
2022-04-28 15:04:13,349 - INFO - Confusion matrix:
2022-04-28 15:04:13,350 - INFO - [[12909    55]
 [ 1144   203]]
2022-04-28 15:04:14,992 - INFO - Epoch: 5 | Validation Loss: 40.2553
2022-04-28 15:29:53,545 - INFO - Custom bins confusion matrix:
2022-04-28 15:29:53,547 - INFO - [[1658608  388081   38329   10589    3840    1630     802     423     588
      113]
 [ 258899  768856  154128   34404   11617    4905    2311    1272    1796
      263]
 [  23860  287996  298766   90882   30840   12825    6128    3297    4703
      696]
 [   6167   61343  200307  124690   55782   25581   12904    7221   10405
     1630]
 [   2630   18777   90991   98280   61137   34497   19213   11472   18999
     3280]
 [   1480    8685   42678   62084   49795   33835   22166   14486   27185
     5661]
 [    878    4753   22672   38645   36264   28193   20490   14655   32338
     8552]
 [    499    2610   13106   24757   25462   21788   17289   13270   33483
    11477]
 [   1303    5637   25718   50000   58834   57519   50197   43113  141657
    87848]
 [    594    2722   10633   19637   26927   26884   27087   25120   98829
    98395]]
2022-04-28 15:30:03,362 - INFO - Confusion matrix:
2022-04-28 15:30:03,363 - INFO - [[59728   493]
 [ 5319  1375]]
2022-04-28 15:30:04,753 - INFO - Epoch: 6 | Train Loss: 50.7020
2022-04-28 15:34:05,453 - INFO - Custom bins confusion matrix:
2022-04-28 15:34:05,454 - INFO - [[387811  53467   5645   1715    709    268    167     82     75      3]
 [ 51992 175816  26466   5524   1887    820    314    200    214      9]
 [  4899  63859  65848  17254   5375   2331    908    395    520      3]
 [  1620  13120  41270  28613  12278   5062   2464   1120   1212     28]
 [   821   4659  15331  20931  15928   8407   4366   2292   2711     96]
 [   497   2377   6835  11371  12104   9519   5860   3513   4875    197]
 [   359   1286   3056   6056   7407   7544   6292   4213   6902    345]
 [   188    726   1871   3715   4189   4810   5183   4543   8946    454]
 [   355   1474   3634   5524   7731   9405  11304  12456  50690   8623]
 [   254    614   1093   1875   2676   3726   4832   5960  36540  14118]]
2022-04-28 15:34:08,259 - INFO - Confusion matrix:
2022-04-28 15:34:08,260 - INFO - [[12905    59]
 [ 1146   201]]
2022-04-28 15:34:09,594 - INFO - Epoch: 6 | Validation Loss: 39.0356
2022-04-28 15:59:44,334 - INFO - Custom bins confusion matrix:
2022-04-28 15:59:44,336 - INFO - [[1671153  380920   34774    9623    3332    1499     716     391     523
       72]
 [ 248106  786486  150591   32770   10675    4646    2177    1138    1615
      247]
 [  21398  285186  307500   90297   29830   11984    5740    3061    4349
      648]
 [   5419   57180  202680  127724   56455   25836   12268    6846   10157
     1465]
 [   2266   17000   89437   99763   62601   35262   19635   11750   18560
     3002]
 [   1310    7719   41533   62606   51257   34469   22398   14457   26899
     5407]
 [    783    4310   21965   38485   36700   28573   20918   14849   32522
     8335]
 [    440    2387   12639   24196   25728   22005   17497   13261   34261
    11327]
 [   1183    5105   24651   48435   57266   57037   50683   43343  143839
    90284]
 [    420    2186    9541   17881   25986   25777   26447   24488  100007
   104095]]
2022-04-28 15:59:55,137 - INFO - Confusion matrix:
2022-04-28 15:59:55,137 - INFO - [[59702   519]
 [ 5299  1395]]
2022-04-28 15:59:56,532 - INFO - Epoch: 7 | Train Loss: 48.9022
2022-04-28 16:04:05,420 - INFO - Custom bins confusion matrix:
2022-04-28 16:04:05,422 - INFO - [[382587  58714   5431   1660    802    384    208     69     87      0]
 [ 40471 185461  28278   5070   2036    943    461    239    282      1]
 [  3070  61673  70091  16927   5147   2210    984    539    747      4]
 [  1049  10757  44540  28944  11376   4928   2377   1197   1602     17]
 [   577   3624  16149  21840  15560   8097   4304   2243   3015    133]
 [   334   1730   6540  12166  12520   9412   5772   3259   5089    326]
 [   298    826   2835   6128   7966   7632   6188   4066   7019    502]
 [   162    549   1490   3658   4404   5140   5299   4370   8929    624]
 [   263   1369   3029   5269   7646   9479  11026  12225  50634  10256]
 [   171    639   1042   1648   2430   3513   4862   6305  35513  15565]]
2022-04-28 16:04:08,342 - INFO - Confusion matrix:
2022-04-28 16:04:08,343 - INFO - [[12917    47]
 [ 1158   189]]
2022-04-28 16:04:09,762 - INFO - Epoch: 7 | Validation Loss: 37.7617
2022-04-28 16:29:49,405 - INFO - Custom bins confusion matrix:
2022-04-28 16:29:49,407 - INFO - [[1682072  374271   32062    8672    3129    1268     621     329     496
       83]
 [ 239985  800515  148488   30905    9881    4139    1937     938    1448
      215]
 [  19470  279713  316049   90722   29416   11648    5550    2732    4091
      602]
 [   4792   52295  204438  130419   57286   25729   12930    6837    9899
     1405]
 [   2015   15067   88806  101319   63482   35532   19947   11511   18687
     2910]
 [   1085    7078   40573   62479   51937   34977   22878   14648   27101
     5299]
 [    665    3868   21359   38648   36769   28979   21033   15001   32741
     8377]
 [    371    2073   12145   24217   25379   22548   17657   13600   34338
    11413]
 [    918    4556   22971   47251   56997   56308   50749   43393  145957
    92726]
 [    402    2029    8900   16803   24725   25131   26032   24147  100985
   107674]]
2022-04-28 16:29:59,550 - INFO - Confusion matrix:
2022-04-28 16:29:59,551 - INFO - [[59713   508]
 [ 5228  1466]]
2022-04-28 16:30:00,892 - INFO - Epoch: 8 | Train Loss: 47.2716
2022-04-28 16:34:11,645 - INFO - Custom bins confusion matrix:
2022-04-28 16:34:11,647 - INFO - [[398214  43969   4843   1661    636    292    113     97    112      5]
 [ 53008 176593  25508   4757   1874    751    302    162    279      8]
 [  4589  59696  72627  16191   4621   1876    749    422    607     14]
 [  1283  10182  45143  30527  11189   4309   1978    887   1265     24]
 [   670   3462  15798  23527  16249   7592   3593   1914   2645     92]
 [   346   1721   6289  12792  12947   9827   5467   2884   4608    267]
 [   296    879   2689   6528   8336   7864   6275   3971   6203    419]
 [   175    565   1418   3685   4705   5463   5648   4461   7931    574]
 [   289   1198   3021   5488   8192  10406  11588  12876  47990  10148]
 [   164    503   1093   1776   2621   3854   5159   6260  34828  15430]]
2022-04-28 16:34:14,423 - INFO - Confusion matrix:
2022-04-28 16:34:14,423 - INFO - [[12916    48]
 [ 1144   203]]
2022-04-28 16:34:15,927 - INFO - Epoch: 8 | Validation Loss: 36.9776
2022-04-28 16:59:45,447 - INFO - Custom bins confusion matrix:
2022-04-28 16:59:45,449 - INFO - [[1690607  369790   29386    7885    2739    1172     549     320     472
       83]
 [ 231709  815899  144575   29267    9028    3728    1789     921    1347
      188]
 [  17701  280631  319114   90477   28610   11184    5200    2730    3804
      542]
 [   4346   49846  206795  132463   57687   25570   12305    6354    9344
     1320]
 [   1821   14036   88422  102399   64924   35568   19886   11412   17969
     2839]
 [    939    6294   39900   62517   52336   35844   22902   14912   27105
     5306]
 [    537    3476   20412   37927   37151   29371   21639   15511   33254
     8162]
 [    332    1945   11466   23273   25623   22470   18115   13828   35297
    11392]
 [    835    4141   21152   45775   56609   56461   51158   44068  147610
    94017]
 [    338    1815    8096   15127   23528   24592   25587   24101  101423
   112221]]
2022-04-28 16:59:55,463 - INFO - Confusion matrix:
2022-04-28 16:59:55,464 - INFO - [[59706   515]
 [ 5185  1509]]
2022-04-28 16:59:56,914 - INFO - Epoch: 9 | Train Loss: 45.8692
2022-04-28 17:04:02,473 - INFO - Custom bins confusion matrix:
2022-04-28 17:04:02,475 - INFO - [[392832  50284   4394   1355    532    243    109     61    118     14]
 [ 43881 189815  22174   4079   1653    806    326    189    292     27]
 [  4099  67350  67735  14026   4095   1894    967    431    719     76]
 [  1399  12716  47481  27211   9349   4033   2041    966   1484    107]
 [   778   4192  17918  23601  13980   6609   3446   2008   2805    205]
 [   486   1928   7412  13790  12690   8170   4856   2680   4771    365]
 [   339    879   3199   7131   8843   7337   5515   3365   6291    561]
 [   185    637   1784   3870   5326   5340   5214   3703   7795    771]
 [   376   1458   3084   5740   8484  10646  11513  11858  48204   9833]
 [   166    563   1158   1782   2601   3579   4772   5686  35513  15868]]
2022-04-28 17:04:05,004 - INFO - Confusion matrix:
2022-04-28 17:04:05,004 - INFO - [[12907    57]
 [ 1136   211]]
2022-04-28 17:04:06,344 - INFO - Epoch: 9 | Validation Loss: 36.9075
2022-04-28 17:25:30,924 - INFO - Custom bins confusion matrix:
2022-04-28 17:25:30,925 - INFO - [[1698367  365110   27475    7276    2425    1060     530     271     434
       55]
 [ 224786  829583  140670   27542    8675    3419    1557     838    1202
      179]
 [  16335  278570  325496   89549   27884   10792    4933    2507    3381
      546]
 [   3956   47498  207130  134859   58363   25465   12288    6442    8844
     1185]
 [   1616   13022   87007  103309   66020   36429   20212   11224   17716
     2721]
 [    827    5953   38481   62960   52981   36364   23271   14978   27131
     5109]
 [    560    3220   19791   37693   37774   29821   21861   15362   33133
     8225]
 [    296    1837   11096   23302   25533   22671   18255   14036   35213
    11502]
 [    729    3671   20778   44971   55623   56501   50876   43838  150007
    94832]
 [    283    1615    7618   14394   22713   23167   25027   23742  101456
   116813]]
2022-04-28 17:25:38,844 - INFO - Confusion matrix:
2022-04-28 17:25:38,844 - INFO - [[59723   498]
 [ 5166  1528]]
2022-04-28 17:25:39,746 - INFO - Epoch: 10 | Train Loss: 44.6065
2022-04-28 17:28:52,804 - INFO - Custom bins confusion matrix:
2022-04-28 17:28:52,805 - INFO - [[398842  44869   3639   1228    443    414    174    150    180      3]
 [ 47978 187715  20354   3739   1473    724    471    268    483     37]
 [  5204  67983  66251  13958   3842   1851    904    467    866     66]
 [  2011  11616  46264  28439   9927   3975   1841   1127   1455    132]
 [  1040   4010  15670  23842  15518   7117   3430   1875   2801    239]
 [   623   1964   6128  12753  14059   8868   4924   3049   4462    318]
 [   433    965   2542   6523   8402   8448   6119   3530   6058    440]
 [   223    541   1507   3478   4692   6006   5732   4289   7547    610]
 [   397   1363   2784   4776   7621  10562  11843  13369  49067   9414]
 [   215    549    846   1417   2303   3337   4614   5547  36146  16714]]
2022-04-28 17:28:54,786 - INFO - Confusion matrix:
2022-04-28 17:28:54,786 - INFO - [[12913    51]
 [ 1141   206]]
2022-04-28 17:28:55,685 - INFO - Epoch: 10 | Validation Loss: 36.4694
2022-04-28 17:50:05,509 - INFO - Custom bins confusion matrix:
2022-04-28 17:50:05,511 - INFO - [[1703728  362822   25493    6609    2300     981     464     221     331
       54]
 [ 218367  842459  137398   25831    7960    3129    1408     704    1063
      132]
 [  15195  278859  328576   89350   27225   10386    4549    2365    3084
      404]
 [   3729   45220  207822  137063   58947   25512   12112    6270    8303
     1052]
 [   1593   12283   85466  104340   66813   37246   20277   11376   17401
     2481]
 [    813    5638   38193   63020   53375   36796   23590   15096   26794
     4740]
 [    475    3055   18976   37972   37512   30205   22100   15607   33701
     7837]
 [    279    1753   10755   23021   25822   22610   18690   14106   35575
    11130]
 [    694    3674   19800   43296   54532   56091   51135   44501  151457
    96646]
 [    227    1431    6990   13150   21920   22686   24303   23630  101002
   121489]]
2022-04-28 17:50:15,240 - INFO - Confusion matrix:
2022-04-28 17:50:15,241 - INFO - [[59755   466]
 [ 5148  1546]]
2022-04-28 17:50:16,283 - INFO - Epoch: 11 | Train Loss: 43.4110
2022-04-28 17:53:55,044 - INFO - Custom bins confusion matrix:
2022-04-28 17:53:55,045 - INFO - [[397242  47416   3064   1089    529    271    130     81    117      3]
 [ 41822 195520  19868   3360   1182    657    327    177    275     54]
 [  4126  68375  68777  13617   3634   1270    574    301    646     72]
 [  1535  11505  46492  30346  10102   3628   1399    646   1020    114]
 [   809   4168  15164  24871  16220   7317   3297   1661   1853    182]
 [   526   1956   6104  12893  13910   9843   5193   2857   3537    329]
 [   365    962   2801   6466   8360   8808   6170   3706   5475    347]
 [   168    754   1590   3544   4560   6143   5835   4338   7277    416]
 [   296   1788   3222   5040   7956  10762  12377  13529  48641   7585]
 [   166    928   1486   1737   2627   3366   4607   5972  36717  14082]]
2022-04-28 17:53:57,228 - INFO - Confusion matrix:
2022-04-28 17:53:57,228 - INFO - [[12927    37]
 [ 1173   174]]
2022-04-28 17:53:58,289 - INFO - Epoch: 11 | Validation Loss: 36.0464
2022-04-28 18:18:41,658 - INFO - Custom bins confusion matrix:
2022-04-28 18:18:41,660 - INFO - [[1709736  359576   23832    6028    2051     815     379     223     317
       46]
 [ 213236  851853  135167   24782    7508    2905    1304     617     962
      117]
 [  14349  277130  332489   89211   26884   10131    4360    2226    2838
      375]
 [   3487   42966  209473  137978   59577   25600   11836    5959    8136
     1018]
 [   1381   11666   85070  105237   67465   37105   20345   11548   17060
     2399]
 [    727    5195   37350   63305   54202   36965   23530   15250   26776
     4755]
 [    485    2963   18808   37446   37932   30550   22214   15733   33657
     7652]
 [    278    1670   10462   22909   26000   22766   18375   14192   36041
    11048]
 [    587    3373   19318   42944   54379   55611   51423   44355  152870
    96966]
 [    200    1386    6769   12341   21132   21581   23610   22970  101149
   125690]]
2022-04-28 18:18:50,897 - INFO - Confusion matrix:
2022-04-28 18:18:50,898 - INFO - [[59695   526]
 [ 5107  1587]]
2022-04-28 18:18:51,958 - INFO - Epoch: 12 | Train Loss: 42.4765
2022-04-28 18:22:23,142 - INFO - Custom bins confusion matrix:
2022-04-28 18:22:23,144 - INFO - [[397306  47177   3088   1225    470    252    148    148    115     13]
 [ 41639 194383  20475   3788   1327    688    279    203    367     93]
 [  4151  63797  70921  14777   4069   1815    751    350    637    124]
 [  1460   9630  44475  32277  10738   4035   1946    952   1140    134]
 [   806   3278  13913  24682  17083   7769   3340   1960   2417    294]
 [   429   1619   5333  12497  14212  10037   5372   2858   4347    444]
 [   356    891   2362   5673   8464   8674   6517   3850   6025    648]
 [   205    567   1370   2974   4727   5740   5790   4394   8017    841]
 [   261   1483   2496   4368   7295  10052  12013  12839  49785  10604]
 [   132    709   1182   1522   2400   3245   4328   5239  36117  16814]]
2022-04-28 18:22:25,826 - INFO - Confusion matrix:
2022-04-28 18:22:25,826 - INFO - [[12919    45]
 [ 1145   202]]
2022-04-28 18:22:27,030 - INFO - Epoch: 12 | Validation Loss: 35.6082
2022-04-28 18:46:59,093 - INFO - Custom bins confusion matrix:
2022-04-28 18:46:59,095 - INFO - [[1712859  357752   22843    5865    1970     809     406     171     282
       46]
 [ 209568  859394  133032   23779    7054    2778    1240     633     857
      116]
 [  13656  275413  335777   89663   26400    9712    4239    2063    2706
      364]
 [   3294   41139  209446  140652   59689   25466   11727    5959    7734
      924]
 [   1344   10997   84357  105951   68960   37308   20102   11317   16694
     2246]
 [    719    4885   36943   63570   54301   37352   23833   15279   26778
     4395]
 [    415    2829   18585   37370   38344   30803   22252   15836   33394
     7612]
 [    232    1561   10441   22884   25934   23109   18402   14241   35868
    11069]
 [    556    3318   18701   42269   53987   55885   51285   44957  153144
    97724]
 [    200    1184    6362   11974   20804   21123   23469   22809  100784
   128119]]
2022-04-28 18:47:09,284 - INFO - Confusion matrix:
2022-04-28 18:47:09,284 - INFO - [[59716   505]
 [ 5069  1625]]
2022-04-28 18:47:10,495 - INFO - Epoch: 13 | Train Loss: 41.7402
2022-04-28 18:50:54,049 - INFO - Custom bins confusion matrix:
2022-04-28 18:50:54,050 - INFO - [[396450  48261   3166    960    438    281    190     96     86     14]
 [ 42241 194852  20068   3310   1221    510    365    296    302     77]
 [  4716  64878  69804  14717   3826   1550    689    426    627    159]
 [  1704  10403  43922  31909  10941   3794   1826    887   1165    236]
 [   782   3875  13933  23766  17205   7813   3540   1772   2564    292]
 [   488   1925   5595  11819  13771   9809   5599   3250   4462    430]
 [   339    930   2455   5893   8060   8001   6512   4023   6596    651]
 [   188    695   1371   3020   4386   5563   5600   4524   8351    927]
 [   251   1615   2629   4582   6934   9378  11210  12224  50175  12198]
 [   133    544   1253   1841   2320   2869   3910   4856  34131  19831]]
2022-04-28 18:50:57,144 - INFO - Confusion matrix:
2022-04-28 18:50:57,144 - INFO - [[12909    55]
 [ 1147   200]]
2022-04-28 18:50:58,627 - INFO - Epoch: 13 | Validation Loss: 35.2201
2022-04-28 19:15:34,563 - INFO - Custom bins confusion matrix:
2022-04-28 19:15:34,565 - INFO - [[1715659  357257   21476    5229    1810     752     348     187     252
       33]
 [ 204872  869255  130041   22608    6614    2438    1152     561     814
       96]
 [  13072  277723  335960   88960   26016    9514    4075    1891    2473
      309]
 [   3105   40129  208930  141713   60238   25692   11749    6114    7403
      957]
 [   1345   10802   83585  106527   68759   37497   20529   11214   16736
     2282]
 [    731    4851   36243   63367   54640   37744   23863   15326   26818
     4472]
 [    391    2728   17984   37246   38249   30887   22427   16013   33930
     7585]
 [    224    1522   10114   22575   25963   23185   18601   14448   36294
    10815]
 [    558    3147   18107   41747   53738   55883   51756   44835  154579
    97476]
 [    190    1250    6136   11244   20027   20531   22733   22542  100991
   131184]]
2022-04-28 19:15:43,689 - INFO - Confusion matrix:
2022-04-28 19:15:43,690 - INFO - [[59678   543]
 [ 5039  1655]]
2022-04-28 19:15:44,729 - INFO - Epoch: 14 | Train Loss: 40.9759
2022-04-28 19:19:19,481 - INFO - Custom bins confusion matrix:
2022-04-28 19:19:19,483 - INFO - [[399442  45849   2776    887    384    227    168    112     83     14]
 [ 46653 191187  19626   3431   1031    460    310    193    296     55]
 [  5369  63379  71512  14674   3512   1291    627    298    641     89]
 [  1810   9940  44639  32789  10662   3434   1632    656   1077    148]
 [   909   3776  13660  25594  16774   7425   3338   1721   2121    224]
 [   518   1940   5558  12692  14046   9595   5427   2935   4107    330]
 [   389   1092   2573   5986   8900   7712   6175   3999   6149    485]
 [   179    768   1465   3293   4981   5671   5136   4202   8244    686]
 [   287   1772   3116   5146   8340  10634  11392  11378  48204  10927]
 [   143   1038   1478   2069   2641   3549   4865   5228  33023  17654]]
2022-04-28 19:19:21,840 - INFO - Confusion matrix:
2022-04-28 19:19:21,840 - INFO - [[12918    46]
 [ 1161   186]]
2022-04-28 19:19:23,025 - INFO - Epoch: 14 | Validation Loss: 35.9699
2022-04-28 19:19:23,037 - INFO - Experiment ended. Checkpoints stored =)
