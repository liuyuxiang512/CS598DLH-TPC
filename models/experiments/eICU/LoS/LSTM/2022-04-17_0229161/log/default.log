2022-04-17 02:29:16,133 - INFO - Config:
2022-04-17 02:29:16,134 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/eICU/LoS/LSTM",
    "batch_size": 512,
    "batch_size_test": 32,
    "batchnorm": "mybatchnorm",
    "bidirectional": false,
    "channelwise": false,
    "dataset": "eICU",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "LSTM",
    "hidden_size": 128,
    "intermediate_reporting": false,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00129,
    "loss": "msle",
    "lstm_dropout_rate": 0.2,
    "main_dropout_rate": 0.45,
    "mode": "train",
    "n_epochs": 8,
    "n_layers": 2,
    "name": "LSTM",
    "no_diag": false,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "percentage_data": 100.0,
    "save_results_csv": false,
    "seed": 2694024149,
    "shuffle_train": false,
    "sum_losses": true,
    "task": "LoS"
}
2022-04-17 02:29:21,076 - INFO - Experiment set up.
2022-04-17 02:29:24,146 - INFO - BaseLSTM(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (lstm_dropout): Dropout(p=0.2, inplace=False)
  (main_dropout): Dropout(p=0.45, inplace=False)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (empty_module): EmptyModule()
  (lstm): LSTM(176, 128, num_layers=2, dropout=0.2)
  (diagnosis_encoder): Linear(in_features=293, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_los): Linear(in_features=257, out_features=17, bias=True)
  (point_mort): Linear(in_features=257, out_features=17, bias=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
)
2022-04-17 02:44:53,857 - INFO - Custom bins confusion matrix:
2022-04-17 02:44:53,859 - INFO - [[1105101  743595  136450   52527   25914   14177    8365    5221    9654
     1999]
 [ 477018  488272  129743   59709   32051   18363   10855    7032   12850
     2558]
 [ 221462  301150  102457   53104   29933   17895   11217    6882   13178
     2715]
 [ 115470  193272   79320   44376   25871   15741   10174    6646   12613
     2547]
 [  67355  130444   61137   35968   21986   13765    8992    5845   11337
     2447]
 [  42374   92149   48434   29656   18580   11801    7461    5115   10332
     2153]
 [  27861   67798   38690   24917   15736   10203    6623    4322    9211
     2079]
 [  18700   50860   31419   20738   13326    8699    5854    3911    8315
     1919]
 [  46753  148859  102445   70542   47458   31468   21127   14166   31088
     7920]
 [  22172   80066   64243   48984   34815   23886   16726   11953   26500
     7483]]
2022-04-17 02:45:02,658 - INFO - Epoch: 0 | Train Loss: 111.9020
2022-04-17 02:48:08,175 - INFO - Custom bins confusion matrix:
2022-04-17 02:48:08,177 - INFO - [[171032 218843  33622  14026   7177   3296   1253    512    181      0]
 [ 60140 131118  33444  19853  11153   4885   1790    685    174      0]
 [ 24419  73341  25608  18198  11631   5413   2024    623    135      0]
 [ 11891  42951  17835  15312  10983   5269   1805    605    136      0]
 [  6256  26390  13379  12252   9724   5152   1690    531    168      0]
 [  3857  17753  10492  10124   8070   4451   1678    539    184      0]
 [  2579  11730   8017   8265   6969   3575   1695    453    177      0]
 [  1694   8540   6278   6759   6031   3386   1417    325    195      0]
 [  3049  23052  20242  23706  22026  11586   4786   2245    504      0]
 [  1388  11930  11943  15347  14494   9356   4460   1914    856      0]]
2022-04-17 02:48:10,740 - INFO - Epoch: 0 | Validation Loss: 100.7504
2022-04-17 03:03:12,876 - INFO - Custom bins confusion matrix:
2022-04-17 03:03:12,877 - INFO - [[1050524  809729  131897   51440   24731   13121    7473    4718    7975
     1395]
 [ 408762  532985  142734   67492   35659   19307   11299    6696   11793
     1724]
 [ 177492  315260  114564   62209   34991   20231   12155    7599   13365
     2127]
 [  86393  194198   88501   52673   31227   18771   11773    7254   13085
     2155]
 [  48049  125492   67972   42938   26543   16323   10504    6674   12570
     2211]
 [  29147   85151   52184   35321   22910   14486    9248    6120   11440
     2048]
 [  18229   60664   41221   29676   19532   12395    8133    5255   10401
     1934]
 [  11609   43910   33051   24453   16658   10875    7233    4671    9389
     1892]
 [  26221  121291  103982   82602   57629   39295   26778   18210   37398
     8420]
 [  11174   57369   61924   55654   41989   30065   21331   15149   33602
     8571]]
2022-04-17 03:03:22,492 - INFO - Epoch: 1 | Train Loss: 101.3315
2022-04-17 03:06:28,243 - INFO - Custom bins confusion matrix:
2022-04-17 03:06:28,244 - INFO - [[195403 196800  33908  13659   6318   2549    924    274    107      0]
 [ 68902 122381  36467  20017  10081   3760   1165    383     86      0]
 [ 27958  68882  28402  19096  10780   4385   1329    487     73      0]
 [ 13862  40147  19789  16367  10546   4194   1223    531    128      0]
 [  7357  24600  14824  13137   9640   4112   1193    531    148      0]
 [  4459  16652  11566  10561   8014   3828   1423    460    185      0]
 [  2972  10933   8644   8831   6786   3284   1424    430    156      0]
 [  2019   7872   6678   7268   5873   3248   1186    316    165      0]
 [  3997  20993  20994  25051  21660  11720   4248   2041    492      0]
 [  1911  10878  12230  16091  14240   9043   4726   1882    687      0]]
2022-04-17 03:06:30,473 - INFO - Epoch: 1 | Validation Loss: 96.6371
2022-04-17 03:22:08,504 - INFO - Custom bins confusion matrix:
2022-04-17 03:22:08,506 - INFO - [[1028702  831879  133592   51199   24342   12771    7327    4398    7473
     1320]
 [ 384756  548360  149785   69745   35923   19499   10939    6619   11106
     1719]
 [ 162765  319515  121030   65255   35949   20680   12233    7565   12797
     2204]
 [  77709  194422   91938   55579   32509   19330   11812    7390   13009
     2332]
 [  42691  123682   70077   45417   28025   16975   10764    6684   12664
     2297]
 [  25596   82690   54009   37251   23880   15051    9369    6197   11710
     2302]
 [  15860   57626   42247   31143   20700   13339    8409    5366   10607
     2143]
 [   9882   41102   33587   25653   17413   11668    7487    5019    9856
     2074]
 [  21778  110295  104102   85816   61855   41747   28221   18982   39848
     9182]
 [   8921   49768   60280   56143   43578   31718   22719   16331   37398
     9972]]
2022-04-17 03:22:19,724 - INFO - Epoch: 2 | Train Loss: 97.7698
2022-04-17 03:25:35,009 - INFO - Custom bins confusion matrix:
2022-04-17 03:25:35,010 - INFO - [[202108 187049  35598  14456   6749   2583   1045    251    103      0]
 [ 70287 117543  37813  21106  10682   3925   1428    353    105      0]
 [ 28538  66070  28624  19816  11485   4771   1653    359     76      0]
 [ 14227  38118  20184  16815  10798   4628   1525    400     92      0]
 [  7507  23199  15252  13250   9963   4390   1430    478     73      0]
 [  4474  15964  11491  10828   8367   4098   1386    453     87      0]
 [  3091  10276   8709   9210   6885   3471   1302    405    111      0]
 [  2022   7521   6748   7375   6337   3159   1093    220    150      0]
 [  4037  20103  20925  26053  22676  11418   4304   1449    231      0]
 [  1925  10511  12439  16728  15079   8415   4634   1549    408      0]]
2022-04-17 03:25:37,462 - INFO - Epoch: 2 | Validation Loss: 95.6649
2022-04-17 03:40:36,628 - INFO - Custom bins confusion matrix:
2022-04-17 03:40:36,629 - INFO - [[1031754  831285  132205   51141   24080   12724    7127    4276    7193
     1218]
 [ 376147  553180  152129   71175   36153   19556   11053    6623   10828
     1607]
 [ 156396  320140  123435   67094   37269   20932   12390    7456   12817
     2064]
 [  73748  192713   94453   56897   33436   20017   11771    7375   13359
     2261]
 [  39902  121556   71525   46761   28942   17428   10883    7020   12908
     2351]
 [  23662   80183   54894   38417   24630   15784    9885    6273   12064
     2263]
 [  14384   55447   42857   32165   21208   13558    8818    5775   11043
     2185]
 [   8901   39042   33776   26375   18128   12034    7833    5236   10306
     2110]
 [  19675  101646  102812   87990   63800   43948   29927   20085   42332
     9611]
 [   7739   43271   57254   56004   44728   33484   24287   17472   41044
    11545]]
2022-04-17 03:40:46,193 - INFO - Epoch: 3 | Train Loss: 95.1475
2022-04-17 03:43:53,203 - INFO - Custom bins confusion matrix:
2022-04-17 03:43:53,204 - INFO - [[203079 185414  37147  13999   6361   2424   1027    367    124      0]
 [ 69166 117974  39857  20368   9790   4003   1428    437    219      0]
 [ 28016  66202  30092  19087  10911   4596   1839    491    158      0]
 [ 13997  37952  21401  16614  10026   4425   1696    522    154      0]
 [  7361  23056  16426  12805   9411   4227   1610    493    153      0]
 [  4310  15959  12297  10412   8093   3918   1532    523    104      0]
 [  2909  10533   9099   8819   6774   3337   1340    511    138      0]
 [  1955   7556   7267   7139   6003   3036   1131    355    183      0]
 [  3974  20405  22092  25479  21233  11610   4355   1645    403      0]
 [  1974  10558  13095  16773  14068   8429   4120   2155    516      0]]
2022-04-17 03:43:55,407 - INFO - Epoch: 3 | Validation Loss: 95.0902
2022-04-17 03:59:01,248 - INFO - Custom bins confusion matrix:
2022-04-17 03:59:01,249 - INFO - [[1038212  828858  130540   50183   23632   12227    7113    4051    6951
     1236]
 [ 373944  554478  153211   71811   36145   19197   10917    6435   10631
     1682]
 [ 153543  319648  125146   67996   37285   21094   12377    7671   13051
     2182]
 [  71525  191818   95586   57636   33912   19971   12008    7544   13685
     2345]
 [  38319  119499   72637   47359   29146   18151   11393    7202   13136
     2434]
 [  22282   78605   55150   39249   25198   15985   10186    6522   12469
     2409]
 [  13723   52959   43386   32906   21728   13846    8997    5860   11708
     2327]
 [   8504   36932   33741   26942   18821   12301    8082    5424   10765
     2229]
 [  18263   94850  101331   88654   65525   45202   30945   21554   44876
    10626]
 [   6818   38888   54189   55770   45909   34369   25265   18431   43895
    13294]]
2022-04-17 03:59:09,895 - INFO - Epoch: 4 | Train Loss: 93.1897
2022-04-17 04:02:21,093 - INFO - Custom bins confusion matrix:
2022-04-17 04:02:21,095 - INFO - [[194903 189102  38718  15060   7165   2950   1290    508    246      0]
 [ 64365 118567  40333  21221  10993   4737   1895    798    333      0]
 [ 25763  65621  29382  19642  11884   5485   2399    914    302      0]
 [ 12921  37198  20335  16732  10671   5347   2438    762    383      0]
 [  6783  22280  15592  12888   9569   5064   2303    702    361      0]
 [  4037  15305  11577  10166   8300   4626   1987    796    354      0]
 [  2727  10046   8510   8615   6841   3849   1770    744    358      0]
 [  1915   7279   6682   6740   5973   3439   1740    563    294      0]
 [  3763  19066  20484  23895  20958  13731   5810   2402   1087      0]
 [  1798   9890  11986  15499  13955   9330   4866   2905   1459      0]]
2022-04-17 04:02:23,547 - INFO - Epoch: 4 | Validation Loss: 94.6401
2022-04-17 04:17:22,450 - INFO - Custom bins confusion matrix:
2022-04-17 04:17:22,451 - INFO - [[1052522  817569  129774   49328   22932   12005    6812    4069    6834
     1158]
 [ 376167  552082  154426   71347   35620   19167   10831    6377   10714
     1720]
 [ 152777  317147  127276   69027   37430   21036   12547    7559   12949
     2245]
 [  70867  187917   97602   58759   34577   20207   12202    7726   13791
     2382]
 [  37254  116985   73426   48669   29467   18194   11592    7371   13731
     2587]
 [  21652   75926   55486   40224   26097   16406   10347    6566   12812
     2539]
 [  13034   50868   43398   33371   22492   14377    9182    6145   12056
     2517]
 [   7906   35200   33793   27044   19246   12753    8393    5656   11243
     2507]
 [  17165   87493  100475   89420   66627   46402   32008   22296   47660
    12280]
 [   6164   34624   51161   54364   45958   35008   26180   19273   48020
    16076]]
2022-04-17 04:17:30,962 - INFO - Epoch: 5 | Train Loss: 91.2834
2022-04-17 04:20:34,027 - INFO - Custom bins confusion matrix:
2022-04-17 04:20:34,028 - INFO - [[215013 171475  36446  14639   6800   3059   1433    635    442      0]
 [ 73212 111895  38592  20450  10509   4942   2110    912    615      5]
 [ 29991  62668  28240  19268  11253   5726   2529   1055    662      0]
 [ 14968  35757  20116  15995  10400   5262   2572    912    805      0]
 [  8098  21616  15140  12447   8967   5174   2443   1089    568      0]
 [  4798  15191  11178   9680   7625   4843   2201    985    647      0]
 [  3249   9949   8355   7933   6487   3988   1861   1003    635      0]
 [  2249   7276   6398   6493   5381   3557   1847    894    530      0]
 [  4769  19244  19750  22495  18960  13664   7062   3175   2077      0]
 [  2238   9957  11573  14206  12864   9745   5436   2982   2687      0]]
2022-04-17 04:20:36,197 - INFO - Epoch: 5 | Validation Loss: 93.9630
2022-04-17 04:35:37,768 - INFO - Custom bins confusion matrix:
2022-04-17 04:35:37,770 - INFO - [[1063341  810054  129357   48716   22098   11484    6409    3863    6494
     1187]
 [ 377814  549383  156536   71845   35249   18939   10423    6262   10262
     1738]
 [ 152581  314595  129076   69974   37519   21147   12318    7451   13047
     2285]
 [  69524  186416   98981   59939   34575   20258   12261    7706   13854
     2516]
 [  35848  115215   74771   49203   30289   18609   11611    7329   13679
     2722]
 [  20760   74160   56355   40625   26080   16558   10427    6855   13337
     2898]
 [  12392   49236   43678   34127   22760   14462    9517    6101   12366
     2801]
 [   7329   33734   33741   27633   19465   12846    8478    5695   11947
     2873]
 [  16113   81832   98883   90121   67680   47123   32881   22775   50507
    13911]
 [   5691   31482   48620   53173   45184   35316   26628   20255   51624
    18855]]
2022-04-17 04:35:46,853 - INFO - Epoch: 6 | Train Loss: 89.6923
2022-04-17 04:38:52,749 - INFO - Custom bins confusion matrix:
2022-04-17 04:38:52,750 - INFO - [[217208 165995  37228  15403   7336   3667   1525    799    781      0]
 [ 74867 107989  38430  20666  11230   5303   2631   1104   1022      0]
 [ 31123  59869  27806  19213  11607   6159   3133   1420   1059      3]
 [ 15701  34100  19703  15608  10538   5889   2886   1110   1248      4]
 [  8680  20447  14729  11785   9283   5427   2825   1346   1020      0]
 [  5227  14290  10938   8970   7736   5079   2564   1220   1124      0]
 [  3506   9449   7967   7359   6456   4193   2234   1259   1037      0]
 [  2447   6870   6114   5990   5299   3824   2038   1173    870      0]
 [  5301  18001  18765  20601  18932  13461   8324   4231   3580      0]
 [  2696   9384  11395  13302  11648   9572   6353   3683   3655      0]]
2022-04-17 04:38:54,857 - INFO - Epoch: 6 | Validation Loss: 94.3175
2022-04-17 04:54:08,907 - INFO - Custom bins confusion matrix:
2022-04-17 04:54:08,908 - INFO - [[1073518  805298  126492   47630   21685   11167    6092    3643    6246
     1232]
 [ 379953  549749  156241   71427   34983   18227   10119    5861   10162
     1729]
 [ 152691  314631  129919   69654   37559   20822   12167    7368   12798
     2384]
 [  69043  185095   99746   60197   34895   20370   12105    7691   14110
     2778]
 [  35596  113435   75374   50100   30484   18407   11453    7392   14073
     2962]
 [  20213   72795   56406   41192   26626   16553   10713    6925   13562
     3070]
 [  11899   47918   43500   34384   22985   14849    9552    6231   13066
     3056]
 [   7113   32438   33447   27892   19617   12884    8766    6026   12477
     3081]
 [  15216   77382   96430   89887   68278   47528   33601   23524   54053
    15927]
 [   5253   29165   45343   50902   44418   35424   27476   21031   55764
    22052]]
2022-04-17 04:54:17,772 - INFO - Epoch: 7 | Train Loss: 88.3093
2022-04-17 04:57:23,185 - INFO - Custom bins confusion matrix:
2022-04-17 04:57:23,187 - INFO - [[223956 160929  34416  15402   7412   3922   1956    933    998     18]
 [ 77836 106407  36000  20770  10895   5866   2840   1254   1360     14]
 [ 32540  59466  26028  19110  11366   6654   3342   1519   1366      1]
 [ 16400  34185  18675  15396  10220   6005   3193   1324   1386      3]
 [  9079  20864  13839  11643   8953   5485   3026   1390   1263      0]
 [  5475  14433  10530   9045   7244   4891   2824   1384   1322      0]
 [  3711   9450   7602   7560   5941   4062   2473   1339   1320      2]
 [  2642   6871   5767   6129   5032   3702   2101   1226   1155      0]
 [  5702  18696  17604  20607  18208  13313   7877   4670   4517      2]
 [  2866   9621  10608  13028  11547   8956   6638   4252   4161     11]]
2022-04-17 04:57:25,477 - INFO - Epoch: 7 | Validation Loss: 94.5001
2022-04-17 04:57:25,488 - INFO - Experiment ended. Checkpoints stored =)
